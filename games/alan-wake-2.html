<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Game Detail</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 10px;
            background: linear-gradient(90deg, #00f0ff, #00ffaa);
            color: #000;
            font-weight: bold;
            animation: glow 1.5s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px #0ff; }
            to { box-shadow: 0 0 20px #0ff; }
        }
    </style>
</head>
<body>
<main class="game-page">
    <div class="top-section" style="display: flex; gap: 20px; align-items: flex-start;">
        <div class="video-wrapper-left" style="flex: 0 0 60%;">
            <iframe
                    id="video-frame"
                    width="100%"
                    height="400"
                    frameborder="0"
                    allowfullscreen
                    allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
            </iframe>
        </div>
        <div class="info-wrapper-right" style="flex: 0 0 40%;">
            <h1 id="game-title">Loading title...</h1>
            <p><strong>Release Date:</strong> <span id="release-date">Loading...</span></p>
            <div id="tag-container" class="tag-bar"></div>
            <section class="description">
                <h2>Description</h2>
                <p id="description">Loading description...</p>
            </section>
            <section class="additional-info" style="margin-top: 20px;">
                <h2>Game Info</h2>
                <p><strong>Developer:</strong> Remedy Entertainment</p>
                <p><strong>Publisher:</strong> Epic Games Publishing</p>
                <p><strong>Platforms:</strong> PC, PlayStation 5, Xbox Series X/S</p>
                <p><strong>Rating:</strong> ★★★★☆ 4.5/5</p>
            </section>
        </div>
    </div>

    <div class="performance-section" style="display: flex; margin-top: 40px; gap: 20px;">
        <div class="fps-chart-container" style="flex: 0 0 60%;">
            <h2 class="fps-header neon">FPS Benchmark</h2>
            <canvas id="fpsChart" height="150"></canvas>
        </div>
        <div class="insights-container" style="flex: 0 0 40%;">
            <h2 class="fps-header neon">Insights</h2>
            <div id="fps-insight-content"
                 style="background: #111; padding: 15px; border-radius: 8px; color: #0ff;"></div>
            <div id="comparison-content"
                 style="background: #111; padding: 15px; margin-top: 20px; border-radius: 8px; color: #0ff;"></div>
        </div>
    </div>

    <a href="../index.html" class="back-link">
        <i data-lucide="gamepad-2"></i> Back to My Gameplays
    </a>
</main>

<script>
    const gameTitle = "Alan Wake 2";

    fetch("../assets/Game_Data.json")
      .then(res => res.json())
      .then(data => {
        const game = data[gameTitle];
        if (!game) return;

        // Set content
        document.getElementById("game-title").textContent = game.title;
        document.getElementById("release-date").textContent = game.release;
        document.getElementById("description").textContent = game.description;
        document.getElementById("video-frame").src = game.youtube;

        // Tags
        const tagContainer = document.getElementById("tag-container");
        game.tags.forEach(tag => {
          const span = document.createElement("span");
          span.className = "tag";
          span.textContent = tag;
          tagContainer.appendChild(span);
        });

        // FPS Chart
        const ctx = document.getElementById("fpsChart")?.getContext("2d");
        if (ctx && game.fps) {
          new Chart(ctx, {
            type: "bar",
            data: {
              labels: ["1080p", "1440p"],
              datasets: [{
                label: "Average FPS",
                data: [game.fps["1080p"], game.fps["1440p"]],
                backgroundColor: ["#00ffffaa", "#00ffaa88"]
              }]
            },
            options: {
              indexAxis: 'y',
              responsive: true,
              plugins: {
                legend: { display: false }
              },
              scales: {
                x: {
                  beginAtZero: true,
                  title: { display: true, text: "FPS", color: "#00ffff" },
                  ticks: { color: "#fff" }
                },
                y: {
                  ticks: { color: "#fff" }
                }
              }
            }
          });
        }

        // Insights Section
        const fps1080 = game.fps["1080p"] || 0;
        let badgeText = "Challenging";
        if (fps1080 >= 90) badgeText = "Ultra Smooth";
        else if (fps1080 >= 60) badgeText = "Optimal";
        else if (fps1080 >= 40) badgeText = "Playable";

        document.getElementById("fps-insight-content").innerHTML = `
          <p><strong>Your PC FPS @1080p:</strong> ${fps1080} FPS</p>
          <p><strong>Playability:</strong> <span class="badge">${badgeText}</span></p>
        `;

        // Comparison Section
        document.getElementById("comparison-content").innerHTML = `
          <h3>Comparison</h3>
          <p>Your PC (RTX 3060 + i5-12400): ${fps1080} FPS</p>
          <p>High-End PC (RTX 4070 Super + i7-13700K): 75 FPS</p>
          <p>Gaming Laptop (RTX 4060 Laptop GPU): 45 FPS</p>
        `;
      })
      .catch(err => console.error("Failed to load game data:", err));
</script>
</body>
</html>
